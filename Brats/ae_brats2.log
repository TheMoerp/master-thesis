2025-05-23 15:03:17,316 - INFO - Using GPU: NVIDIA GeForce RTX 3060 Ti
2025-05-23 15:03:17,317 - INFO - Starting dataset processing...
2025-05-23 15:03:19,155 - INFO - Processing 50 subjects...
2025-05-23 15:03:19,155 - INFO - Processing subject 1/50: BraTS-GLI-00000-000
2025-05-23 15:04:27,027 - INFO - Using GPU: NVIDIA GeForce RTX 3060 Ti
2025-05-23 15:04:27,029 - INFO - Starting dataset processing...
2025-05-23 15:04:28,842 - INFO - Processing 2 subjects...
2025-05-23 15:04:28,842 - INFO - Processing subject 1/2: BraTS-GLI-00000-000
2025-05-23 15:09:36,439 - INFO - Processing subject 2/2: BraTS-GLI-00002-000
2025-05-23 15:14:36,828 - INFO - Extracted 200 healthy patches
2025-05-23 15:14:36,829 - INFO - Extracted 100 anomalous patches
2025-05-23 15:14:37,205 - INFO - Training set: 160 patches
2025-05-23 15:14:37,206 - INFO - Test set: 140 patches (40 healthy, 100 anomalous)
2025-05-23 15:14:37,337 - INFO - Model created with 4877572 parameters
2025-05-23 15:14:37,652 - INFO - Starting training...
2025-05-23 15:14:37,653 - INFO - Epoch 1/100
2025-05-23 15:14:38,287 - INFO - Batch 0/10, Loss: 2024367.0000
2025-05-23 15:14:38,994 - INFO - Train Loss: 1717370.6625, Val Loss: 1582822.6250
2025-05-23 15:14:39,129 - INFO - New best model saved!
2025-05-23 15:14:39,130 - INFO - Epoch 2/100
2025-05-23 15:14:39,258 - INFO - Batch 0/10, Loss: 1405144.6250
2025-05-23 15:14:39,944 - INFO - Train Loss: 1630303.3375, Val Loss: 1562355.4375
2025-05-23 15:14:40,062 - INFO - New best model saved!
2025-05-23 15:14:40,062 - INFO - Epoch 3/100
2025-05-23 15:14:40,187 - INFO - Batch 0/10, Loss: 1488901.1250
2025-05-23 15:14:40,887 - INFO - Train Loss: 1571614.1000, Val Loss: 1535436.3125
2025-05-23 15:14:41,015 - INFO - New best model saved!
2025-05-23 15:14:41,015 - INFO - Epoch 4/100
2025-05-23 15:14:41,145 - INFO - Batch 0/10, Loss: 1829406.6250
2025-05-23 15:14:41,820 - INFO - Train Loss: 1552208.4000, Val Loss: 1512739.2500
2025-05-23 15:14:41,928 - INFO - New best model saved!
2025-05-23 15:14:41,928 - INFO - Epoch 5/100
2025-05-23 15:14:42,055 - INFO - Batch 0/10, Loss: 1516002.8750
2025-05-23 15:14:42,714 - INFO - Train Loss: 1536776.6875, Val Loss: 1499504.1250
2025-05-23 15:14:42,826 - INFO - New best model saved!
2025-05-23 15:14:42,826 - INFO - Epoch 6/100
2025-05-23 15:14:42,944 - INFO - Batch 0/10, Loss: 1524976.8750
2025-05-23 15:14:43,609 - INFO - Train Loss: 1537444.5000, Val Loss: 1496884.7500
2025-05-23 15:14:43,717 - INFO - New best model saved!
2025-05-23 15:14:43,717 - INFO - Epoch 7/100
2025-05-23 15:14:43,840 - INFO - Batch 0/10, Loss: 1592408.2500
2025-05-23 15:14:44,497 - INFO - Train Loss: 1526900.4375, Val Loss: 1488335.5625
2025-05-23 15:14:44,610 - INFO - New best model saved!
2025-05-23 15:14:44,611 - INFO - Epoch 8/100
2025-05-23 15:14:44,729 - INFO - Batch 0/10, Loss: 1433720.0000
2025-05-23 15:14:45,388 - INFO - Train Loss: 1512878.1375, Val Loss: 1475707.0000
2025-05-23 15:14:45,496 - INFO - New best model saved!
2025-05-23 15:14:45,497 - INFO - Epoch 9/100
2025-05-23 15:14:45,622 - INFO - Batch 0/10, Loss: 1625297.8750
2025-05-23 15:14:46,277 - INFO - Train Loss: 1497296.9250, Val Loss: 1460684.3750
2025-05-23 15:14:46,392 - INFO - New best model saved!
2025-05-23 15:14:46,392 - INFO - Epoch 10/100
2025-05-23 15:14:46,509 - INFO - Batch 0/10, Loss: 1239054.1250
2025-05-23 15:14:47,161 - INFO - Train Loss: 1479030.0500, Val Loss: 1439915.6875
2025-05-23 15:14:47,266 - INFO - New best model saved!
2025-05-23 15:14:47,267 - INFO - Epoch 11/100
2025-05-23 15:14:47,396 - INFO - Batch 0/10, Loss: 1824939.7500
2025-05-23 15:14:48,072 - INFO - Train Loss: 1462473.4500, Val Loss: 1447406.0625
2025-05-23 15:14:48,072 - INFO - Epoch 12/100
2025-05-23 15:14:48,203 - INFO - Batch 0/10, Loss: 1376844.6250
2025-05-23 15:14:48,864 - INFO - Train Loss: 1436646.6625, Val Loss: 1390826.5625
2025-05-23 15:14:48,977 - INFO - New best model saved!
2025-05-23 15:14:48,977 - INFO - Epoch 13/100
2025-05-23 15:14:49,096 - INFO - Batch 0/10, Loss: 1274507.8750
2025-05-23 15:14:49,756 - INFO - Train Loss: 1401897.7625, Val Loss: 1372184.7500
2025-05-23 15:14:49,869 - INFO - New best model saved!
2025-05-23 15:14:49,869 - INFO - Epoch 14/100
2025-05-23 15:14:49,987 - INFO - Batch 0/10, Loss: 1645777.0000
2025-05-23 15:14:50,644 - INFO - Train Loss: 1365795.5875, Val Loss: 1318052.6875
2025-05-23 15:14:50,762 - INFO - New best model saved!
2025-05-23 15:14:50,763 - INFO - Epoch 15/100
2025-05-23 15:14:50,881 - INFO - Batch 0/10, Loss: 1579820.2500
2025-05-23 15:14:51,540 - INFO - Train Loss: 1327494.5125, Val Loss: 1264142.1875
2025-05-23 15:14:51,651 - INFO - New best model saved!
2025-05-23 15:14:51,652 - INFO - Epoch 16/100
2025-05-23 15:14:51,781 - INFO - Batch 0/10, Loss: 1232479.7500
2025-05-23 15:14:52,456 - INFO - Train Loss: 1292394.8000, Val Loss: 1196173.3125
2025-05-23 15:14:52,591 - INFO - New best model saved!
2025-05-23 15:14:52,592 - INFO - Epoch 17/100
2025-05-23 15:14:52,718 - INFO - Batch 0/10, Loss: 1297509.5000
2025-05-23 15:14:53,390 - INFO - Train Loss: 1270090.5750, Val Loss: 1173838.4688
2025-05-23 15:14:53,504 - INFO - New best model saved!
2025-05-23 15:14:53,504 - INFO - Epoch 18/100
2025-05-23 15:14:53,622 - INFO - Batch 0/10, Loss: 1285838.8750
2025-05-23 15:14:54,277 - INFO - Train Loss: 1249182.6125, Val Loss: 1149537.4062
2025-05-23 15:14:54,388 - INFO - New best model saved!
2025-05-23 15:14:54,389 - INFO - Epoch 19/100
2025-05-23 15:14:54,507 - INFO - Batch 0/10, Loss: 1092619.1250
2025-05-23 15:14:55,159 - INFO - Train Loss: 1219491.2875, Val Loss: 1141450.3750
2025-05-23 15:14:55,269 - INFO - New best model saved!
2025-05-23 15:14:55,269 - INFO - Epoch 20/100
2025-05-23 15:14:55,390 - INFO - Batch 0/10, Loss: 1145224.8750
2025-05-23 15:14:56,052 - INFO - Train Loss: 1224463.7188, Val Loss: 1124937.0312
2025-05-23 15:14:56,168 - INFO - New best model saved!
2025-05-23 15:14:56,168 - INFO - Epoch 21/100
2025-05-23 15:14:56,291 - INFO - Batch 0/10, Loss: 1345479.3750
2025-05-23 15:14:56,959 - INFO - Train Loss: 1189762.3062, Val Loss: 1082059.8750
2025-05-23 15:14:57,077 - INFO - New best model saved!
2025-05-23 15:14:57,077 - INFO - Epoch 22/100
2025-05-23 15:14:57,197 - INFO - Batch 0/10, Loss: 1181553.6250
2025-05-23 15:14:57,860 - INFO - Train Loss: 1179492.6375, Val Loss: 1085549.9375
2025-05-23 15:14:57,861 - INFO - Epoch 23/100
2025-05-23 15:14:57,988 - INFO - Batch 0/10, Loss: 1004156.0625
2025-05-23 15:14:58,651 - INFO - Train Loss: 1164752.5000, Val Loss: 1076578.6250
2025-05-23 15:14:58,763 - INFO - New best model saved!
2025-05-23 15:14:58,764 - INFO - Epoch 24/100
2025-05-23 15:14:58,883 - INFO - Batch 0/10, Loss: 1100860.6250
2025-05-23 15:14:59,545 - INFO - Train Loss: 1148410.5000, Val Loss: 1037701.5000
2025-05-23 15:14:59,655 - INFO - New best model saved!
2025-05-23 15:14:59,656 - INFO - Epoch 25/100
2025-05-23 15:14:59,779 - INFO - Batch 0/10, Loss: 1206514.8750
2025-05-23 15:15:00,438 - INFO - Train Loss: 1132472.8000, Val Loss: 1031986.2188
2025-05-23 15:15:00,550 - INFO - New best model saved!
2025-05-23 15:15:00,550 - INFO - Epoch 26/100
2025-05-23 15:15:00,676 - INFO - Batch 0/10, Loss: 1162085.3750
2025-05-23 15:15:01,331 - INFO - Train Loss: 1108589.9812, Val Loss: 1092774.5625
2025-05-23 15:15:01,332 - INFO - Epoch 27/100
2025-05-23 15:15:01,466 - INFO - Batch 0/10, Loss: 991067.6875
2025-05-23 15:15:02,121 - INFO - Train Loss: 1103003.5312, Val Loss: 1015556.0625
2025-05-23 15:15:02,231 - INFO - New best model saved!
2025-05-23 15:15:02,231 - INFO - Epoch 28/100
2025-05-23 15:15:02,366 - INFO - Batch 0/10, Loss: 1063075.1250
2025-05-23 15:15:03,028 - INFO - Train Loss: 1098878.5000, Val Loss: 982602.5625
2025-05-23 15:15:03,128 - INFO - New best model saved!
2025-05-23 15:15:03,128 - INFO - Epoch 29/100
2025-05-23 15:15:03,253 - INFO - Batch 0/10, Loss: 1141824.0000
2025-05-23 15:15:03,920 - INFO - Train Loss: 1085772.5250, Val Loss: 979238.7500
2025-05-23 15:15:04,031 - INFO - New best model saved!
2025-05-23 15:15:04,032 - INFO - Epoch 30/100
2025-05-23 15:15:04,152 - INFO - Batch 0/10, Loss: 1064465.1250
2025-05-23 15:15:04,818 - INFO - Train Loss: 1071028.2312, Val Loss: 979865.5938
2025-05-23 15:15:04,819 - INFO - Epoch 31/100
2025-05-23 15:15:04,952 - INFO - Batch 0/10, Loss: 1230254.6250
2025-05-23 15:15:05,613 - INFO - Train Loss: 1061036.7625, Val Loss: 978669.1562
2025-05-23 15:15:05,722 - INFO - New best model saved!
2025-05-23 15:15:05,723 - INFO - Epoch 32/100
2025-05-23 15:15:05,846 - INFO - Batch 0/10, Loss: 1001762.2500
2025-05-23 15:15:06,505 - INFO - Train Loss: 1085237.6125, Val Loss: 969577.8750
2025-05-23 15:15:06,613 - INFO - New best model saved!
2025-05-23 15:15:06,614 - INFO - Epoch 33/100
2025-05-23 15:15:06,732 - INFO - Batch 0/10, Loss: 1252990.7500
2025-05-23 15:15:07,390 - INFO - Train Loss: 1048252.0750, Val Loss: 965035.5625
2025-05-23 15:15:07,507 - INFO - New best model saved!
2025-05-23 15:15:07,507 - INFO - Epoch 34/100
2025-05-23 15:15:07,631 - INFO - Batch 0/10, Loss: 1018231.8125
2025-05-23 15:15:08,293 - INFO - Train Loss: 1050627.9312, Val Loss: 930944.8125
2025-05-23 15:15:08,410 - INFO - New best model saved!
2025-05-23 15:15:08,410 - INFO - Epoch 35/100
2025-05-23 15:15:08,543 - INFO - Batch 0/10, Loss: 919731.5625
2025-05-23 15:15:09,211 - INFO - Train Loss: 1028112.9062, Val Loss: 932121.1875
2025-05-23 15:15:09,211 - INFO - Epoch 36/100
2025-05-23 15:15:09,331 - INFO - Batch 0/10, Loss: 1013272.3750
2025-05-23 15:15:09,985 - INFO - Train Loss: 1031253.4062, Val Loss: 957038.1250
2025-05-23 15:15:09,986 - INFO - Epoch 37/100
2025-05-23 15:15:10,112 - INFO - Batch 0/10, Loss: 1323388.8750
2025-05-23 15:15:10,776 - INFO - Train Loss: 1028077.9313, Val Loss: 920580.3125
2025-05-23 15:15:10,884 - INFO - New best model saved!
2025-05-23 15:15:10,885 - INFO - Epoch 38/100
2025-05-23 15:15:11,002 - INFO - Batch 0/10, Loss: 989335.3750
2025-05-23 15:15:11,662 - INFO - Train Loss: 1023735.9625, Val Loss: 914357.1562
2025-05-23 15:15:11,778 - INFO - New best model saved!
2025-05-23 15:15:11,779 - INFO - Epoch 39/100
2025-05-23 15:15:11,902 - INFO - Batch 0/10, Loss: 815150.7500
2025-05-23 15:15:12,565 - INFO - Train Loss: 1010838.7188, Val Loss: 911049.3125
2025-05-23 15:15:12,674 - INFO - New best model saved!
2025-05-23 15:15:12,675 - INFO - Epoch 40/100
2025-05-23 15:15:12,803 - INFO - Batch 0/10, Loss: 1075297.2500
2025-05-23 15:15:13,469 - INFO - Train Loss: 1000952.4000, Val Loss: 897084.3750
2025-05-23 15:15:13,583 - INFO - New best model saved!
2025-05-23 15:15:13,583 - INFO - Epoch 41/100
2025-05-23 15:15:13,702 - INFO - Batch 0/10, Loss: 882529.5625
2025-05-23 15:15:14,362 - INFO - Train Loss: 990894.6312, Val Loss: 881495.8125
2025-05-23 15:15:14,482 - INFO - New best model saved!
2025-05-23 15:15:14,482 - INFO - Epoch 42/100
2025-05-23 15:15:14,611 - INFO - Batch 0/10, Loss: 1036983.4375
2025-05-23 15:15:15,288 - INFO - Train Loss: 989365.4375, Val Loss: 872976.1875
2025-05-23 15:15:15,407 - INFO - New best model saved!
2025-05-23 15:15:15,407 - INFO - Epoch 43/100
2025-05-23 15:15:15,545 - INFO - Batch 0/10, Loss: 844758.0000
2025-05-23 15:15:16,230 - INFO - Train Loss: 964959.2562, Val Loss: 891492.2188
2025-05-23 15:15:16,231 - INFO - Epoch 44/100
2025-05-23 15:15:16,353 - INFO - Batch 0/10, Loss: 976994.8750
2025-05-23 15:15:17,026 - INFO - Train Loss: 968364.9125, Val Loss: 862848.2812
2025-05-23 15:15:17,145 - INFO - New best model saved!
2025-05-23 15:15:17,146 - INFO - Epoch 45/100
2025-05-23 15:15:17,265 - INFO - Batch 0/10, Loss: 1038209.2500
2025-05-23 15:15:17,923 - INFO - Train Loss: 956083.4563, Val Loss: 865904.9688
2025-05-23 15:15:17,924 - INFO - Epoch 46/100
2025-05-23 15:15:18,045 - INFO - Batch 0/10, Loss: 882794.6875
2025-05-23 15:15:18,705 - INFO - Train Loss: 953045.7188, Val Loss: 848954.4688
2025-05-23 15:15:18,821 - INFO - New best model saved!
2025-05-23 15:15:18,822 - INFO - Epoch 47/100
2025-05-23 15:15:18,952 - INFO - Batch 0/10, Loss: 928989.3125
2025-05-23 15:15:19,618 - INFO - Train Loss: 944895.6062, Val Loss: 843646.9062
2025-05-23 15:15:19,729 - INFO - New best model saved!
2025-05-23 15:15:19,729 - INFO - Epoch 48/100
2025-05-23 15:15:19,863 - INFO - Batch 0/10, Loss: 890600.6875
2025-05-23 15:15:20,525 - INFO - Train Loss: 935761.3625, Val Loss: 826326.8438
2025-05-23 15:15:20,636 - INFO - New best model saved!
2025-05-23 15:15:20,637 - INFO - Epoch 49/100
2025-05-23 15:15:20,760 - INFO - Batch 0/10, Loss: 936720.7500
2025-05-23 15:15:21,421 - INFO - Train Loss: 930800.1125, Val Loss: 816795.0000
2025-05-23 15:15:21,533 - INFO - New best model saved!
2025-05-23 15:15:21,534 - INFO - Epoch 50/100
2025-05-23 15:15:21,663 - INFO - Batch 0/10, Loss: 953296.4375
2025-05-23 15:15:22,328 - INFO - Train Loss: 919228.5437, Val Loss: 882612.8750
2025-05-23 15:15:22,328 - INFO - Epoch 51/100
2025-05-23 15:15:22,460 - INFO - Batch 0/10, Loss: 881640.9375
2025-05-23 15:15:23,122 - INFO - Train Loss: 907577.9625, Val Loss: 829135.4062
2025-05-23 15:15:23,122 - INFO - Epoch 52/100
2025-05-23 15:15:23,243 - INFO - Batch 0/10, Loss: 997816.0000
2025-05-23 15:15:23,910 - INFO - Train Loss: 903525.1750, Val Loss: 800429.8438
2025-05-23 15:15:24,020 - INFO - New best model saved!
2025-05-23 15:15:24,021 - INFO - Epoch 53/100
2025-05-23 15:15:24,141 - INFO - Batch 0/10, Loss: 908562.5625
2025-05-23 15:15:24,816 - INFO - Train Loss: 897122.2625, Val Loss: 801840.6875
2025-05-23 15:15:24,817 - INFO - Epoch 54/100
2025-05-23 15:15:24,942 - INFO - Batch 0/10, Loss: 869369.5000
2025-05-23 15:15:25,616 - INFO - Train Loss: 888756.1937, Val Loss: 786799.4062
2025-05-23 15:15:25,732 - INFO - New best model saved!
2025-05-23 15:15:25,732 - INFO - Epoch 55/100
2025-05-23 15:15:25,866 - INFO - Batch 0/10, Loss: 765831.1250
2025-05-23 15:15:26,531 - INFO - Train Loss: 873973.6312, Val Loss: 786770.7812
2025-05-23 15:15:26,643 - INFO - New best model saved!
2025-05-23 15:15:26,644 - INFO - Epoch 56/100
2025-05-23 15:15:26,764 - INFO - Batch 0/10, Loss: 968715.3750
2025-05-23 15:15:27,423 - INFO - Train Loss: 880405.1937, Val Loss: 759108.5938
2025-05-23 15:15:27,544 - INFO - New best model saved!
2025-05-23 15:15:27,545 - INFO - Epoch 57/100
2025-05-23 15:15:27,680 - INFO - Batch 0/10, Loss: 892801.1875
2025-05-23 15:15:28,343 - INFO - Train Loss: 872434.0125, Val Loss: 766594.7188
2025-05-23 15:15:28,343 - INFO - Epoch 58/100
2025-05-23 15:15:28,466 - INFO - Batch 0/10, Loss: 817709.0000
2025-05-23 15:15:29,130 - INFO - Train Loss: 861637.8125, Val Loss: 784233.8438
2025-05-23 15:15:29,131 - INFO - Epoch 59/100
2025-05-23 15:15:29,257 - INFO - Batch 0/10, Loss: 912400.5625
2025-05-23 15:15:29,919 - INFO - Train Loss: 860298.3500, Val Loss: 756330.6875
2025-05-23 15:15:30,039 - INFO - New best model saved!
2025-05-23 15:15:30,039 - INFO - Epoch 60/100
2025-05-23 15:15:30,169 - INFO - Batch 0/10, Loss: 876007.2500
2025-05-23 15:15:30,835 - INFO - Train Loss: 837363.2500, Val Loss: 723313.2188
2025-05-23 15:15:30,954 - INFO - New best model saved!
2025-05-23 15:15:30,955 - INFO - Epoch 61/100
2025-05-23 15:15:31,080 - INFO - Batch 0/10, Loss: 815234.6250
2025-05-23 15:15:31,744 - INFO - Train Loss: 831152.6687, Val Loss: 735812.2812
2025-05-23 15:15:31,745 - INFO - Epoch 62/100
2025-05-23 15:15:31,872 - INFO - Batch 0/10, Loss: 910680.5000
2025-05-23 15:15:32,537 - INFO - Train Loss: 824789.6438, Val Loss: 737582.7812
2025-05-23 15:15:32,538 - INFO - Epoch 63/100
2025-05-23 15:15:32,659 - INFO - Batch 0/10, Loss: 799550.6875
2025-05-23 15:15:33,320 - INFO - Train Loss: 824926.0938, Val Loss: 758704.3125
2025-05-23 15:15:33,321 - INFO - Epoch 64/100
2025-05-23 15:15:33,449 - INFO - Batch 0/10, Loss: 739946.6875
2025-05-23 15:15:34,129 - INFO - Train Loss: 813206.2000, Val Loss: 753759.9375
2025-05-23 15:15:34,130 - INFO - Epoch 65/100
2025-05-23 15:15:34,279 - INFO - Batch 0/10, Loss: 818425.6250
2025-05-23 15:15:34,946 - INFO - Train Loss: 810250.4875, Val Loss: 737950.3438
2025-05-23 15:15:34,947 - INFO - Epoch 66/100
2025-05-23 15:15:35,071 - INFO - Batch 0/10, Loss: 691189.3125
2025-05-23 15:15:35,756 - INFO - Train Loss: 808231.8313, Val Loss: 689903.5625
2025-05-23 15:15:35,892 - INFO - New best model saved!
2025-05-23 15:15:35,892 - INFO - Epoch 67/100
2025-05-23 15:15:36,027 - INFO - Batch 0/10, Loss: 792744.0625
2025-05-23 15:15:36,693 - INFO - Train Loss: 790093.4688, Val Loss: 670272.1875
2025-05-23 15:15:36,807 - INFO - New best model saved!
2025-05-23 15:15:36,808 - INFO - Epoch 68/100
2025-05-23 15:15:36,931 - INFO - Batch 0/10, Loss: 825699.5000
2025-05-23 15:15:37,613 - INFO - Train Loss: 782281.5000, Val Loss: 712794.9062
2025-05-23 15:15:37,613 - INFO - Epoch 69/100
2025-05-23 15:15:37,739 - INFO - Batch 0/10, Loss: 765816.8125
2025-05-23 15:15:38,413 - INFO - Train Loss: 778174.9375, Val Loss: 672016.3750
2025-05-23 15:15:38,414 - INFO - Epoch 70/100
2025-05-23 15:15:38,539 - INFO - Batch 0/10, Loss: 861131.9375
2025-05-23 15:15:39,210 - INFO - Train Loss: 764522.4812, Val Loss: 659788.0938
2025-05-23 15:15:39,344 - INFO - New best model saved!
2025-05-23 15:15:39,345 - INFO - Epoch 71/100
2025-05-23 15:15:39,475 - INFO - Batch 0/10, Loss: 732989.3750
2025-05-23 15:15:40,157 - INFO - Train Loss: 767978.8187, Val Loss: 670415.5312
2025-05-23 15:15:40,158 - INFO - Epoch 72/100
2025-05-23 15:15:40,282 - INFO - Batch 0/10, Loss: 658638.7500
2025-05-23 15:15:41,032 - INFO - Train Loss: 759604.5500, Val Loss: 670125.0312
2025-05-23 15:15:41,032 - INFO - Epoch 73/100
2025-05-23 15:15:41,159 - INFO - Batch 0/10, Loss: 749837.8750
2025-05-23 15:15:41,852 - INFO - Train Loss: 751830.0813, Val Loss: 678826.6875
2025-05-23 15:15:41,853 - INFO - Epoch 74/100
2025-05-23 15:15:41,984 - INFO - Batch 0/10, Loss: 756741.3750
2025-05-23 15:15:42,698 - INFO - Train Loss: 744659.4563, Val Loss: 629587.8125
2025-05-23 15:15:42,838 - INFO - New best model saved!
2025-05-23 15:15:42,839 - INFO - Epoch 75/100
2025-05-23 15:15:42,979 - INFO - Batch 0/10, Loss: 732279.8125
2025-05-23 15:15:43,666 - INFO - Train Loss: 748787.4812, Val Loss: 647047.9688
2025-05-23 15:15:43,666 - INFO - Epoch 76/100
2025-05-23 15:15:43,788 - INFO - Batch 0/10, Loss: 873474.3125
2025-05-23 15:15:44,455 - INFO - Train Loss: 738379.3187, Val Loss: 645827.2188
2025-05-23 15:15:44,455 - INFO - Epoch 77/100
2025-05-23 15:15:44,588 - INFO - Batch 0/10, Loss: 702731.3750
2025-05-23 15:15:45,280 - INFO - Train Loss: 727894.0000, Val Loss: 631780.3125
2025-05-23 15:15:45,281 - INFO - Epoch 78/100
2025-05-23 15:15:45,409 - INFO - Batch 0/10, Loss: 811357.0000
2025-05-23 15:15:46,113 - INFO - Train Loss: 731453.4938, Val Loss: 649279.4688
2025-05-23 15:15:46,114 - INFO - Epoch 79/100
2025-05-23 15:15:46,248 - INFO - Batch 0/10, Loss: 885808.7500
2025-05-23 15:15:46,960 - INFO - Train Loss: 728065.4125, Val Loss: 661917.2500
2025-05-23 15:15:46,961 - INFO - Epoch 80/100
2025-05-23 15:15:47,090 - INFO - Batch 0/10, Loss: 762357.3125
2025-05-23 15:15:47,781 - INFO - Train Loss: 716956.6000, Val Loss: 652576.5312
2025-05-23 15:15:47,782 - INFO - Epoch 81/100
2025-05-23 15:15:47,916 - INFO - Batch 0/10, Loss: 750470.6250
2025-05-23 15:15:48,616 - INFO - Train Loss: 718024.5687, Val Loss: 602057.1875
2025-05-23 15:15:48,733 - INFO - New best model saved!
2025-05-23 15:15:48,734 - INFO - Epoch 82/100
2025-05-23 15:15:48,866 - INFO - Batch 0/10, Loss: 603956.7500
2025-05-23 15:15:49,580 - INFO - Train Loss: 713113.3625, Val Loss: 611958.5000
2025-05-23 15:15:49,581 - INFO - Epoch 83/100
2025-05-23 15:15:49,726 - INFO - Batch 0/10, Loss: 684241.3125
2025-05-23 15:15:50,468 - INFO - Train Loss: 693288.6625, Val Loss: 629050.1875
2025-05-23 15:15:50,469 - INFO - Epoch 84/100
2025-05-23 15:15:50,615 - INFO - Batch 0/10, Loss: 666841.8750
2025-05-23 15:15:51,347 - INFO - Train Loss: 693159.2875, Val Loss: 609156.1562
2025-05-23 15:15:51,348 - INFO - Epoch 85/100
2025-05-23 15:15:51,478 - INFO - Batch 0/10, Loss: 705716.8750
2025-05-23 15:15:52,193 - INFO - Train Loss: 697476.3875, Val Loss: 594185.0625
2025-05-23 15:15:52,365 - INFO - New best model saved!
2025-05-23 15:15:52,366 - INFO - Epoch 86/100
2025-05-23 15:15:52,503 - INFO - Batch 0/10, Loss: 683263.4375
2025-05-23 15:15:53,212 - INFO - Train Loss: 688790.7312, Val Loss: 612041.0312
2025-05-23 15:15:53,212 - INFO - Epoch 87/100
2025-05-23 15:15:53,366 - INFO - Batch 0/10, Loss: 606675.1875
2025-05-23 15:15:54,073 - INFO - Train Loss: 684751.7250, Val Loss: 599256.1875
2025-05-23 15:15:54,073 - INFO - Epoch 88/100
2025-05-23 15:15:54,216 - INFO - Batch 0/10, Loss: 724614.2500
2025-05-23 15:15:54,930 - INFO - Train Loss: 680385.0938, Val Loss: 569688.7500
2025-05-23 15:15:55,071 - INFO - New best model saved!
2025-05-23 15:15:55,072 - INFO - Epoch 89/100
2025-05-23 15:15:55,235 - INFO - Batch 0/10, Loss: 708229.0000
2025-05-23 15:15:55,938 - INFO - Train Loss: 678799.0000, Val Loss: 579911.5781
2025-05-23 15:15:55,939 - INFO - Epoch 90/100
2025-05-23 15:15:56,069 - INFO - Batch 0/10, Loss: 597677.1875
2025-05-23 15:15:56,771 - INFO - Train Loss: 678355.2063, Val Loss: 573854.0625
2025-05-23 15:15:56,771 - INFO - Epoch 91/100
2025-05-23 15:15:56,930 - INFO - Batch 0/10, Loss: 848361.0000
2025-05-23 15:15:57,661 - INFO - Train Loss: 690981.6312, Val Loss: 601641.7500
2025-05-23 15:15:57,662 - INFO - Epoch 92/100
2025-05-23 15:15:57,796 - INFO - Batch 0/10, Loss: 627369.3750
2025-05-23 15:15:58,489 - INFO - Train Loss: 671541.4125, Val Loss: 573168.1719
2025-05-23 15:15:58,489 - INFO - Epoch 93/100
2025-05-23 15:15:58,613 - INFO - Batch 0/10, Loss: 597800.3750
2025-05-23 15:15:59,298 - INFO - Train Loss: 669689.8750, Val Loss: 569442.6719
2025-05-23 15:15:59,413 - INFO - New best model saved!
2025-05-23 15:15:59,413 - INFO - Epoch 94/100
2025-05-23 15:15:59,538 - INFO - Batch 0/10, Loss: 587983.0625
2025-05-23 15:16:00,222 - INFO - Train Loss: 683187.2000, Val Loss: 595758.6875
2025-05-23 15:16:00,222 - INFO - Epoch 95/100
2025-05-23 15:16:00,354 - INFO - Batch 0/10, Loss: 606712.8125
2025-05-23 15:16:01,042 - INFO - Train Loss: 676908.7438, Val Loss: 569197.6094
2025-05-23 15:16:01,155 - INFO - New best model saved!
2025-05-23 15:16:01,155 - INFO - Epoch 96/100
2025-05-23 15:16:01,293 - INFO - Batch 0/10, Loss: 576230.7500
2025-05-23 15:16:02,019 - INFO - Train Loss: 667958.8562, Val Loss: 572108.7969
2025-05-23 15:16:02,019 - INFO - Epoch 97/100
2025-05-23 15:16:02,170 - INFO - Batch 0/10, Loss: 684507.2500
2025-05-23 15:16:02,869 - INFO - Train Loss: 664024.3375, Val Loss: 560391.8125
2025-05-23 15:16:02,996 - INFO - New best model saved!
2025-05-23 15:16:02,996 - INFO - Epoch 98/100
2025-05-23 15:16:03,130 - INFO - Batch 0/10, Loss: 657934.1250
2025-05-23 15:16:03,818 - INFO - Train Loss: 657952.6312, Val Loss: 562697.6406
2025-05-23 15:16:03,818 - INFO - Epoch 99/100
2025-05-23 15:16:03,954 - INFO - Batch 0/10, Loss: 685377.1250
2025-05-23 15:16:04,645 - INFO - Train Loss: 666841.0250, Val Loss: 565153.8438
2025-05-23 15:16:04,645 - INFO - Epoch 100/100
2025-05-23 15:16:04,770 - INFO - Batch 0/10, Loss: 680987.3750
2025-05-23 15:16:05,457 - INFO - Train Loss: 654373.2688, Val Loss: 560712.2969
2025-05-23 15:16:05,465 - INFO - Training completed!
2025-05-23 15:16:06,334 - INFO - Evaluating anomaly detection performance...
2025-05-23 15:16:06,608 - INFO - Anomaly Detection Results:
2025-05-23 15:16:06,608 - INFO - roc_auc: 0.7548
2025-05-23 15:16:06,608 - INFO - average_precision: 0.8782
2025-05-23 15:16:06,609 - INFO - accuracy: 0.7357
2025-05-23 15:16:06,609 - INFO - precision: 0.8387
2025-05-23 15:16:06,609 - INFO - recall: 0.7800
2025-05-23 15:16:06,609 - INFO - f1_score: 0.8083
2025-05-23 15:16:06,610 - INFO - optimal_threshold: 0.5850
2025-05-23 15:16:45,293 - INFO - Training and evaluation completed! Results saved to ae_brats2_results
2025-05-23 15:16:45,293 - INFO - To visualize training progress, run: tensorboard --logdir ae_brats2_results/tensorboard
2025-05-23 15:29:28,172 - INFO - Starting BraTS Anomaly Detection with 3D Autoencoder
2025-05-23 15:29:28,173 - INFO - Using device: cuda
2025-05-23 15:29:28,173 - INFO - Configuration: {'dataset_path': 'datasets/BraTS2025-GLI-PRE-Challenge-TrainingData', 'num_subjects': 2, 'patch_size': 32, 'patches_per_volume': 20, 'train_ratio': 0.8, 'latent_dim': 128, 'learning_rate': 0.001, 'batch_size': 4, 'epochs': 10, 'weight_decay': 1e-05, 'device': device(type='cuda'), 'num_workers': 4, 'seed': 42, 'output_dir': 'ae_brats2_results', 'save_model': False, 'visualize': True, 'anomaly_threshold_percentile': 95}
2025-05-23 15:29:29,954 - INFO - Found 1251 subjects in dataset
2025-05-23 15:29:29,955 - INFO - Using 2 subjects as requested
2025-05-23 15:29:29,955 - INFO - Extracting patches from volumes...
2025-05-23 15:29:32,288 - INFO - Extracted 40 normal patches
2025-05-23 15:29:32,288 - INFO - Extracted 40 anomaly patches
2025-05-23 15:29:32,312 - INFO - Dataset shape: (80, 4, 32, 32, 32)
2025-05-23 15:29:32,313 - INFO - Labels shape: (80,)
2025-05-23 15:29:32,334 - INFO - Training samples: 32
2025-05-23 15:29:32,335 - INFO - Validation samples: 8
2025-05-23 15:29:32,335 - INFO - Test samples: 48 (Normal: 8, Anomaly: 40)
2025-05-23 15:29:32,803 - INFO - Starting training on cuda
2025-05-23 15:29:32,804 - INFO - Model parameters: 2,857,924
